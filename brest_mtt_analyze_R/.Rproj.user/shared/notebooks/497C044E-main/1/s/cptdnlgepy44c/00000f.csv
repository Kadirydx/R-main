"0","make_outlier_NA <- function(df, rf = 1.5, exclude_wells = NULL) {"
"0","  vec <- as.vector(df)"
"0","  wells <- as.vector(outer(rownames(df), colnames(df), paste0))"
"0","  "
"0","  vec_clean <- vec[!is.na(vec)]"
"0","  Q1 <- quantile(vec_clean, 0.25)"
"0","  Q3 <- quantile(vec_clean, 0.75)"
"0","  IQR_val <- Q3 - Q1"
"0","  lower <- Q1 - rf * IQR_val"
"0","  upper <- Q3 + rf * IQR_val"
"0","  "
"0","  outlier_mask <- vec < lower | vec > upper"
"0","  "
"0","  # Eğer exclude_wells varsa, onları outlier_mask içinden çıkar"
"0","  if (!is.null(exclude_wells)) {"
"0","    exclude_mask <- wells %in% exclude_wells"
"0","    outlier_mask[exclude_mask] <- FALSE"
"0","  }"
"0","  "
"0","  # Sonuç: sadece izin verilen uç değerler NA yapılacak"
"0","  df[outlier_mask] <- NA"
"0","  "
"0","  return(df)"
"0","}"
